---
title: "Keel Evaluations"
author: "Cheyne Springbett"
date: "10/31/2022"
output: pdf_document
---

# Load libraries
```{r}
library(googlesheets4)
```


# Read in Sheets, combine keel dataset
```{r reading in google sheets}
sheetnames=sheet_names("https://docs.google.com/spreadsheets/d/1ckVjS4Jw9o_eg_l_TAwDFNp_evuu36sFHmXyUqT6YqA")
evalnames=grep("Keel Prominence", sheetnames, value=T)

keels=read_sheet("https://docs.google.com/spreadsheets/d/1ckVjS4Jw9o_eg_l_TAwDFNp_evuu36sFHmXyUqT6YqA", sheet=evalnames[1])

for (i in 2:length(evalnames)){
  keels=rbind(
    keels,
    read_sheet("https://docs.google.com/spreadsheets/d/1ckVjS4Jw9o_eg_l_TAwDFNp_evuu36sFHmXyUqT6YqA", sheet=evalnames[i])
  )
}
keels=data.frame(keels)
```

# Quantify Keel Evals
```{r}
code=c("VP", "P", "A","W", "M", "none")
value=c(4,3,2,1,0,NA)
lookup=data.frame(code,value)

for (i in 1:nrow(keels)){
  for (j in 2:6){
    keels[i,j]=lookup$value[lookup$code==keels[i,j]]
  }
}

```

# Convert to numeric
```{r}
keels$O1=as.numeric(keels$O1)
keels$O2=as.numeric(keels$O2)
keels$O3=as.numeric(keels$O3)
keels$O4=as.numeric(keels$O4)
keels$O5=as.numeric(keels$O5)
```


#Combine to get total means between observers
```{r}
dfmean=data.frame(c(
(aggregate(O1~Octopus_Tank,data=keels,FUN="mean",na.action=na.pass)),
(aggregate(O2~Octopus_Tank,data=keels,FUN="mean",na.action=na.pass)),
(aggregate(O3~Octopus_Tank,data=keels,FUN="mean",na.action=na.pass)),
(aggregate(O4~Octopus_Tank,data=keels,FUN="mean",na.action=na.pass)),
(aggregate(O5~Octopus_Tank,data=keels,FUN="mean",na.action=na.pass))
))

dfmean$Octopus_Tank.1<- NULL
dfmean$Octopus_Tank.2<- NULL
dfmean$Octopus_Tank.3<- NULL
dfmean$Octopus_Tank.4<- NULL

```

# Import specific dates of observations
```{r}
dates=grep("Keel Dates", sheetnames, value=T)
keeldate=read_sheet("https://docs.google.com/spreadsheets/d/1ckVjS4Jw9o_eg_l_TAwDFNp_evuu36sFHmXyUqT6YqA", sheet=dates[1])
```

# Convert to date format
```{r}
keeldate$In <- as.Date(keeldate$In, format="%m-%d")
keeldate$O1 <- as.Date(keeldate$O1, format="%m-%d")
keeldate$O2 <- as.Date(keeldate$O2, format="%m-%d")
keeldate$O3 <- as.Date(keeldate$O3, format="%m-%d")
keeldate$O4 <- as.Date(keeldate$O4, format="%m-%d")
keeldate$O5 <- as.Date(keeldate$O5, format="%m-%d")
```

# Get days between observations
```{r}
d1<-keeldate$O1-keeldate$In
d2<-keeldate$O2-keeldate$In
d3<-keeldate$O3-keeldate$In
d4<-keeldate$O4-keeldate$In
d5<-keeldate$O5-keeldate$In
```

```{r}
datedif <- matrix(c(d1,d2,d3,d4,d5), nrow = 5, byrow=TRUE)
colnames(datedif) = keeldate$Octopus_Tank
rownames(datedif) = c("01","O2","O3","O4","O5")
```



